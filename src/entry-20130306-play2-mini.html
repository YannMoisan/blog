$title=Introduction à play2-mini
$description=Introduction à play2-mini, pour les débutants en Scala
-----
<h2>Présentation</h2>
<p>Play2-mini est un framework REST très léger, bâti au dessus de play 2, dont la syntaxe s'inspire de Unfiltered.</p>
<p>L'équipe d'Akka recommande son utilisation pour utiliser du HTTP avec Akka.</p>
<h2>Comment ça marche</h2>
<p>Commençons par regarder le code d'exemple du projet :</p>
<pre class="prettyprint">
object App extends com.typesafe.play.mini.Application {
   def route  =  {
      case GET(Path("/coco")) &amp; QueryString(qs) =&gt;  Action{
          val o = QueryString(qs,"foo").getOrElse("noh")
          Ok(&lt;h1&gt;It works!, query String {o}&lt;/h1&gt;).as("text/html")
      }
      case GET(Path("/flowers")) =&gt;  Action{
          Ok(&lt;h1&gt;It works for flowers!&lt;/h1&gt;).as("text/html")
      }
    }
}
</pre>
<p>Pour un débutant en Scala, ce code semble un peu magique.</p>
<p>Il faut commencer par étendre le trait <code>Application</code>, donc implémenter la méthode <code>route</code>, qui doit renvoyer une <a href="http://www.scala-lang.org/api/current/index.html#scala.PartialFunction"><code>PartialFunction[RequestHeader, Handler]</code></a>.
Une fonction partielle est une fonction qui n'est définie que pour un sous ensemble des valeurs possibles de ces arguments : dans notre cas, que pour certains headers HTTP.</p>
<p>Regardons maintenant la définition des routes : <code> case GET(Path("/coco"))</code>. Ce bout de code utilise le <a href="http://www.scala-lang.org/node/120">pattern matching</a> et des <a href="http://www.scala-lang.org/node/112">extractor</a> personnalisés.
Pour rappel, <code>case Path(p)…</code> est équivalent à <code>p = Path.unapply(…)</code>. Dans notre cas, on chaine les extracteurs, ce qui équivaut à 
<code>p = Path.unapply(GET.unapply(…))</code>. L'astuce consiste pour le unapply de l'objet GET à renvoyer le même objet que celui passé en paramètre.

<p>play2-mini utilise donc très élégamment plusieurs fonctionnalités du langage et est donc une excellente source d'inspiration pour ses propres développements.</p>

<h2>Limites</h2>
<p>play2.1 n'est pas encore supporté (play 2.1-RC2 pour le moment).</p>
<p>~ run n'est pas encore supporté, <a href="https://github.com/typesafehub/play2-mini/issues/10">un bug</a> est ouvert.</p>

<h2>Références</h2>
<ul>
    <li><a href="https://github.com/typesafehub/play2-mini">play2-mini sur GitHub</a></li>
    <li><a href="http://doc.akka.io/docs/akka/2.0.5/modules/http.html">play2-mini dans la doc Akka</a></li>
</ul>



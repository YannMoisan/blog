<!DOCTYPE html>
<html lang="fr"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="6C_Yu8j-I-U3pjFBjHojSiqvDPxhKJuYqap_tSXV8M4" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Jersey vs Spring MVC | Yann Moisan</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Jersey vs Spring MVC" />
<meta property="og:locale" content="fr" />
<meta name="description" content="Comparatif entre Jersey et Spring MVC, deux frameworks Java pour l’implémentation de services REST" />
<meta property="og:description" content="Comparatif entre Jersey et Spring MVC, deux frameworks Java pour l’implémentation de services REST" />
<link rel="canonical" href="https://www.yannmoisan.com/jersey-vs-spring-mvc.html" />
<meta property="og:url" content="https://www.yannmoisan.com/jersey-vs-spring-mvc.html" />
<meta property="og:site_name" content="Yann Moisan" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-05-18T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Jersey vs Spring MVC" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2012-05-18T00:00:00+02:00","datePublished":"2012-05-18T00:00:00+02:00","description":"Comparatif entre Jersey et Spring MVC, deux frameworks Java pour l’implémentation de services REST","headline":"Jersey vs Spring MVC","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.yannmoisan.com/jersey-vs-spring-mvc.html"},"url":"https://www.yannmoisan.com/jersey-vs-spring-mvc.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico" /><link type="application/atom+xml" rel="alternate" href="https://www.yannmoisan.com/feed.xml" title="Yann Moisan" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Yann Moisan</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Posts</a><a class="page-link" href="/news-from-last-month.html">News from last month</a><a class="page-link" href="/a-propos.html">About me</a><a class="page-link" href="/bookmarks.html">Bookmarks</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Jersey vs Spring MVC</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2012-05-18T00:00:00+02:00" itemprop="datePublished">May 18, 2012
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>En Java, il existe de nombreux frameworks pour implémenter un service REST : Spring MVC, Jersey,
RESTEasy, Restlet, Play framework, … Le but de ce billet est de comparer Spring MVC et Jersey. Ce
n’est pas un tutoriel sur REST, il en existe déjà d’excellents sur la toile<sup><a href="#note1">1</a></sup>.
Il suppose que le lecteur a déjà une connaissance des architectures REST.</p>

<p>Afin d’effectuer la comparaison, j’ai développé le même service avec les deux frameworks. Ce service
est accessible en <code class="language-plaintext highlighter-rouge">GET</code>, par l’URI <code class="language-plaintext highlighter-rouge">/fib/{n}</code> et retourne en JSON les n premiers termes de la suite
de Fibonacci.</p>

<h2 id="introduction">Introduction</h2>

<p>Jersey est l’implémentation de référence de la JSR-311 (JAX-RS). Spring MVC, bien que n’implémentant
pas cette JSR, couvre quasiment les mêmes fonctionnalités. J’ai utilisé les dernières versions
disponibles, à savoir 1.12 pour Jersey et 3.1.1 pour Spring. Depuis la version 3.0, il est conseillé
d’utiliser la nouvelle manière de créer des services en utilisant conjointement <code class="language-plaintext highlighter-rouge">@ResponseBody</code> avec
<code class="language-plaintext highlighter-rouge">HttpMessageConverter</code><sup><a href="#note2">2</a></sup>.</p>

<h2 id="aperçu-du-code">Aperçu du code</h2>

<p>Regardons à présent ce qui intéresse tous les développeurs, le code du service.</p>

<p>Jersey</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.yannmoisan.restcmp</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.PathVariable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RequestMethod</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.ResponseBody</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.yannmoisan.restcmp.service.FibService</span><span class="o">;</span>

<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/fib"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FibController</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">FibService</span> <span class="n">service</span><span class="o">;</span>
    
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/{n}"</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="nc">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="s">"application/json"</span><span class="o">)</span>
    <span class="nd">@ResponseBody</span>
    <span class="kd">public</span> <span class="nc">Fib</span> <span class="nf">getFib</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Fib</span><span class="o">(</span><span class="n">service</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">n</span><span class="o">)));</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<p>Spring</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.yannmoisan.restcmp</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.ws.rs.GET</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.PathParam</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.Produces</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.ws.rs.core.MediaType</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.yannmoisan.restcmp.service.FibService</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="nd">@Path</span><span class="o">(</span><span class="s">"/fib/{n}"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FibResource</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">FibService</span> <span class="n">service</span><span class="o">;</span>
    
    <span class="nd">@GET</span>
    <span class="nd">@Produces</span><span class="o">({</span> <span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span> <span class="o">})</span>
    <span class="kd">public</span> <span class="nc">Fib</span> <span class="nf">getFib</span><span class="o">(</span><span class="nd">@PathParam</span><span class="o">(</span><span class="s">"n"</span><span class="o">)</span> <span class="nc">String</span> <span class="n">n</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">Fib</span><span class="o">(</span><span class="n">service</span><span class="o">.</span><span class="na">calculate</span><span class="o">(</span><span class="nc">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">n</span><span class="o">)));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Le code est assez ressemblant, seul les termes changent. Par exemple, <code class="language-plaintext highlighter-rouge">@Path</code> est l’équivalent de
<code class="language-plaintext highlighter-rouge">@RequestMapping</code>.</p>

<h2 id="transformation-en-json">Transformation en JSON</h2>

<p>Jersey a un module jersey-json pour la transformation en JSON, qui offre 3 approches différentes :
POJO, JAXB et bas niveau. Dans notre exemple, on utilise l’approche POJO, la plus simple, basée sur
jackson. Il suffit d’activer le paramètre <code class="language-plaintext highlighter-rouge">POJOMappingFeature</code> sur la servlet.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;init-param&gt;</span>
    <span class="nt">&lt;param-name&gt;</span>com.sun.jersey.api.json.POJOMappingFeature<span class="nt">&lt;/param-name&gt;</span>
    <span class="nt">&lt;param-value&gt;</span>true<span class="nt">&lt;/param-value&gt;</span>
<span class="nt">&lt;/init-param&gt;</span>
</code></pre></div></div>

<p>Avec Spring, il suffit d’indiquer <code class="language-plaintext highlighter-rouge">&lt;mvc:annotation-driven /&gt;</code> et d’ajouter la librairie jackson dans
le classpath. Spring utilise alors automatiquement un <code class="language-plaintext highlighter-rouge">MappingJacksonHttpMessageConverter</code>.</p>

<h2 id="intégration-avec-spring">Intégration avec Spring</h2>

<p>Dans les 2 cas, nous utilisons Spring pour l’injection de dépendances.</p>

<p>Jersey fournit un module jersey-spring qui contient une servlet
<code class="language-plaintext highlighter-rouge">com.sun.jersey.spi.spring.container.servlet.SpringServlet</code> qui réalise l’intégration avec Spring.</p>

<p>Avec Spring, bien évidemment, c’est natif.</p>

<h2 id="tests-automatisés">Tests automatisés</h2>

<p>Jersey embarque nativement un framework de test : jersey-test-framework, qui permet de faire des
tests avec différents conteneurs.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.yannmoisan.restcmp</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.Assert</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.context.ContextLoaderListener</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.sun.jersey.api.client.WebResource</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.sun.jersey.spi.spring.container.servlet.SpringServlet</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.sun.jersey.test.framework.JerseyTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.sun.jersey.test.framework.WebAppDescriptor</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FibResourceTest</span> <span class="kd">extends</span> <span class="nc">JerseyTest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">FibResourceTest</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="k">new</span> <span class="nc">WebAppDescriptor</span><span class="o">.</span><span class="na">Builder</span><span class="o">(</span><span class="s">"com.sun.jersey.samples.springannotations.resources.jerseymanaged"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">contextPath</span><span class="o">(</span><span class="s">"restcmp"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">contextParam</span><span class="o">(</span><span class="s">"contextConfigLocation"</span><span class="o">,</span> <span class="s">"classpath:mvc-dispatcher-servlet.xml"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">servletClass</span><span class="o">(</span><span class="nc">SpringServlet</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                <span class="o">.</span><span class="na">initParam</span><span class="o">(</span><span class="s">"com.sun.jersey.api.json.POJOMappingFeature"</span><span class="o">,</span> <span class="s">"true"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">contextListenerClass</span><span class="o">(</span><span class="nc">ContextLoaderListener</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetFib</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">WebResource</span> <span class="n">webResource</span> <span class="o">=</span> <span class="n">resource</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">responseMsg</span> <span class="o">=</span> <span class="n">webResource</span><span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"fib/10"</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="nc">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">(</span><span class="s">"{\"fib\":[1,1,2,3,5,8,13,21,34,55]}"</span><span class="o">,</span> <span class="n">responseMsg</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Pour Spring, il faut utiliser un autre projet :
<code class="language-plaintext highlighter-rouge">spring-test-mvc</code> qui a vocation à être intégré au
module spring-test de Spring Framework. Ce projet se base sur l’utilisation de Mock et permet de
tester sans conteneur de Servlet. Pour récupérer la dépendance avec Maven, il faut ajouter le
repository maven snapshot de Spring.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="nn">com.yannmoisan.restcmp</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">server</span><span class="o">.</span><span class="na">request</span><span class="o">.</span><span class="na">MockMvcRequestBuilders</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">server</span><span class="o">.</span><span class="na">setup</span><span class="o">.</span><span class="na">MockMvcBuilders</span><span class="o">.*;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">test</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">server</span><span class="o">.</span><span class="na">result</span><span class="o">.</span><span class="na">MockMvcResultMatchers</span><span class="o">.*;</span>

<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.test.web.server.MockMvc</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FibControllerTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetFib</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="nc">String</span> <span class="n">contextLoc</span> <span class="o">=</span> <span class="s">"classpath:mvc-dispatcher-servlet.xml"</span><span class="o">;</span>
        <span class="nc">String</span> <span class="n">warDir</span> <span class="o">=</span> <span class="s">"src/main/webapp"</span><span class="o">;</span>

        <span class="nc">MockMvc</span> <span class="n">mockMvc</span> <span class="o">=</span> <span class="n">xmlConfigSetup</span><span class="o">(</span><span class="n">contextLoc</span><span class="o">).</span><span class="na">configureWebAppRootDir</span><span class="o">(</span><span class="n">warDir</span><span class="o">,</span> <span class="kc">false</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>

        <span class="n">mockMvc</span><span class="o">.</span><span class="na">perform</span><span class="o">(</span><span class="n">get</span><span class="o">(</span><span class="s">"/fib/10"</span><span class="o">)).</span><span class="na">andExpect</span><span class="o">(</span><span class="n">content</span><span class="o">().</span><span class="na">string</span><span class="o">(</span><span class="s">"{\"fib\":[1,1,2,3,5,8,13,21,34,55]}"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="tests-de-bout-en-bout">Tests de bout en bout</h2>

<p>Les tests de bout en bout permettent de vérifier que le résultat est identique, avec les 2 webapps
déployées sur un serveur tomcat.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl http://localhost:8080/restcmp-jersey/fib/10
<span class="o">{</span><span class="s2">"fib"</span>:[1,1,2,3,5,8,13,21,34,55]<span class="o">}</span>
<span class="nv">$ </span>curl http://localhost:8080/restcmp-spring/fib/10
<span class="o">{</span><span class="s2">"fib"</span>:[1,1,2,3,5,8,13,21,34,55]<span class="o">}</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>Ma préférence va à Jersey car il est simple, standard et testable.</p>

<h2 id="ressources-externes">Ressources externes</h2>

<p><a href="https://github.com/YannMoisan/restcmp">Le code source du billet</a></p>
<p id="note1">[1] <a href="http://rest.elkstein.org/">Learn REST: A Tutorial</a></p>
<p id="note2">[2] <del>Supporting XML and JSON web service endpoints in Spring 3.1 using @ResponseBody</del></p>
<p><a href="http://www.vogella.com/articles/REST/article.html">REST with Java (JAX-RS) using Jersey</a></p>
<p><a href="http://www.infoq.com/articles/springmvc_jsx-rs">A Comparison of Spring MVC and JAX-RS</a></p>

  </div><a class="u-url" href="/jersey-vs-spring-mvc.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Yann Moisan</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Yann Moisan</li><li><a class="u-email" href="mailto:yamo93+blog@gmail.com">yamo93+blog@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/YannMoisan"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">YannMoisan</span></a></li><li><a href="https://www.linkedin.com/in/yann-moisan-01771746"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">yann-moisan-01771746</span></a></li><li><a href="https://www.twitter.com/yannmoisan"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">yannmoisan</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Blog de Yann Moisan Scala, Java, Linux</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
